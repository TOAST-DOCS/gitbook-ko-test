## Data & Analytics > Log & Crash Search > 콘솔 사용 가이드

Log & Crash Search는 다음과 같은 순서로 사용할 수 있습니다.

- 서비스 활성화
먼저 프로젝트를 만들고 원하는 프로젝트를 선택한 후, Log & Crash Search를 활성화합니다.
- 로그 전송  
Log & Crash Search SDK를 통해서 로그 전송을 시작합니다.
- 로그 확인  
로그 전송을 마친 후에는 **로그 검색** 화면에서 차트나 검색 등 다양한 방식으로 로그를 살펴볼 수 있습니다.

## 프로젝트 선택

콘솔에 접속하여 왼쪽 메뉴를 이용하여 조직(Organization)과 프로젝트(Project)를 선택합니다. 조직이나 프로젝트가 없다면 새로 만들어야 합니다.
- 왼쪽 메뉴에서 **ORGANIZATION > PROJECT**를 클릭합니다.

조직과 프로젝트를 만드는 자세한 방법은 [NHN Cloud 콘솔 사용 가이드](https://gov-docs.toast.com/ko/TOAST/ko/console-guide-gov/)를 참고하세요.

## 서비스 활성화

프로젝트(Project)를 선택한 상태에서 화면 상단의 **서비스 선택** 버튼을 클릭하고 **Data & Analytics** 아래 **Log & Crash Search**를 클릭합니다. 서비스가 활성화되면 서비스 이름 옆에 선택(v) 표시가 나타납니다.

> [참고]  
> 서비스를 활성화한 후에는 약 5분 이후부터 전송할 수 있습니다.

Log & Crash Search가 활성화되면 왼쪽 메뉴에 **Data & Analytics > Log & Crash Search** 메뉴가 나타나고 Appkey가 생성됩니다.

## Appkey 확인

로그를 전송하려면 Appkey를 확인해야 합니다.

1. 왼쪽 탐색 메뉴에서 **Data & Analytics > Log & Crash Search > 로그 검색**을 클릭합니다.
2. 콘솔 화면 상단에 **URL & Appkey** 버튼을 클릭하면 Log & Crash Search용 Appkey를 확인할 수 있습니다.

## 로그 전송

로그를 전송하려면 Log & Crash Search SDK가 필요합니다.
SDK는 [NHN Cloud Downloads](https://gov-docs.toast.com/ko/Download/) 페이지의 **Data & Analytics > Log & Crash Search**에서 다운로드할 수 있습니다.

> [참고]  
> 세션 로그 전송 시 [리소스 제공 정책](https://gov-docs.toast.com/ko/TOAST/ko/resource-policy-gov/#log-crash-search)의 일일 로그 건수 제공량에는 다른 로그와 동일하게 합산하여 반영되지만, API 호출 요금에는 반영되지 않습니다.

## 로그 검색

이제 전송한 로그를 Log Search 기능을 이용하여 검색해 보겠습니다.

1. 콘솔 화면 왼쪽 메뉴에서 **Data & Analytics > Log & Crash Search > 로그 검색**을 클릭합니다.
2. **로그 검색** 탭에는 기본적으로 24시간 동안의 로그량이 그래프와 상세 내용으로 나옵니다.

**로그 검색** 화면은 다음과 같이 구성되어 있습니다.

![gov_lcs_01_202208](https://static.toastoven.net/prod_logncrash/gov_lcs_01_202208.jpg)

| 항목 | 설명 |
|---|---|
| 검색 쿼리 입력 | 쿼리 필드 검색은 Lucene 문법을 사용할 수 있습니다. <br/> (참고: https://gov-docs.toast.com/ko/Data%20&%20Analytics/Log%20&%20Crash%20Search/ko/gov-lucene-query-guide/)|
| 검색 대상 기간 | 검색 쿼리의 기간 조건을 설정할 수 있습니다. |
| 로그 검색 결과 > 차트 | 로그 검색 결과를 막대 그래프로 출력하며, 막대 그래프 바를 클릭하면 해당 바의 로그 기간만큼 재검색하여 로그를 확인할 수 있습니다. |
| 로그 결과 다운로드 | 로그 검색 결과를 원하는 포맷으로 다운로드할 수 있습니다. |
| 선택한 필드 | 로그 필드에 따라 우측 결과 테이블 컬럼을 변경할 수 있습니다. **추가** 버튼을 통해 다른 필드들을 추가, 삭제할 수 있습니다. |
| 로그 검색 결과 > 로그 레코드 | 검색한 로그의 자세한 내용이 출력되는 부분입니다. 출력된 로그의 각 항목은 클릭하여 검색 쿼리를 변경할 수 있습니다. |

사용자가 설정한 검색 조건은 검색 쿼리 입력 창에 반영되며 자주 사용하는 쿼리라면 쿼리 저장 버튼을 사용해서 저장했다가 이후에 쉽게 불러올 수 있습니다. 저장한 쿼리는 **저장 쿼리 목록**에서 확인 및 관리가 가능합니다.

> [참고]
데이터 길이가 2,000,000 글자를 초과하는 필드를 포함하는 로그는 검색이 불가능합니다. 해당 이슈로 인해 조회가 불가능한 로그는 이슈가 해결되기 전까지 로그 다운로드 기능을 이용해 조회 부탁드립니다.
>

## 알람

로그에 대한 알람 설정 및 알람 발송 이력을 확인할 수 있습니다.
**Data & Analytics > Log & Crash Search > 알람**을 클릭합니다.

### 로그 알람 설정

![gov_lcs_02_202208](https://static.toastoven.net/prod_logncrash/gov_lcs_02_202208.png)

로그 알람에 대한 모든 기능을 수행할 수 있는 페이지입니다.

- 알람은 발생 수에 따른 알람과, 로그의 증감률에 따른 알람으로 구분됩니다.
- 알람 수신을 원하는 로그 유형(Lucene 쿼리)을 등록하고 해당 로그가 발생하면 조건에 따라 알람을 발송합니다.
- [발생 수], [증감률] 두 가지 유형의 알람이 있습니다.
- **알람 추가** 버튼을 누르면 알람을 등록할 수 있습니다.

![gov_lcs_03_202208](https://static.toastoven.net/prod_logncrash/gov_lcs_03_202208.png)

- 알람 설정 방법은 다음과 같습니다.
    - 알람 제목: 알람 설정 목록에 표시될 이름을 입력합니다.
    - 알람 쿼리: 알람 수신을 원하는 로그유형을 Lucene 쿼리로 입력합니다.
    - 설명: 알람 설명을 입력합니다.
    - 알람 유형: 발생 수 또는 증감률로 알람 유형을 설정합니다.
    - 알람 유형이 발생 수일 경우
        - 알람 규칙: **임곗값**에 적용될 부등호를 선택합니다.
        - 임곗값: '검색 조건'에 해당하는 로그가 '알람 규칙' 부등호에 따라 '임곗값' 개수만큼 발생하면 알람을 발송합니다.
        - 발생 주기: 분 단위로 입력하며, 입력한 시간 값 내에 로그가 '임곗값'만큼 발생해야 알람을 발송합니다.
    - 알람 유형이 증감률일 경우
        - 임곗값: '검색 조건'에 해당하는 로그의 증감률입니다. 양수는 로그가 이전 간격 대비 증가한 비율, 0은 이전 간격과 로그양이 동일, 음수는 이전 간격보다 로그 양이 감소한 비율입니다.
        - 비교 시간: 시간 단위로 입력하며, 입력한 시간 간격과 그 이전 간격 사이의 로그양을 '임곗값'에 맞춰 비교합니다. '비교 시간'동안 발생한 로그의 증감률이 '임곗값'을 만족하면, 알람을 발송합니다.
    - 스누즈: 분 단위로 입력하며, 최소 1분~최대 1,440분(24시간) 사이의 값을 설정합니다.(0이면 꺼짐)
    - 수신자: 알람을 수신할 수신자를 입력합니다. 각 수신자마다 이메일과 SMS를 선택할 수 있습니다.
    - SMS 알람 문구: 알람 발송 시 SMS로 보낼 문구를 입력합니다.
    - 콜백 수신지: 알람 발송 시 호출될 URL을 입력합니다. http(s)://와 이메일, 그리고 두레이 훅을 지원합니다.

### 로그 알람 이력

![gov_lcs_04_202208](https://static.toastoven.net/prod_logncrash/gov_lcs_04_202208.png)

- 설정한 알람 목록들이 표시됩니다.
- 목록 클릭시 해당 알람 발생 내역을 확인할 수 있습니다.

## 설정

검색 필드 관리, 이슈 트래커 설정, 심벌 파일 관리 등 서비스에 필요한 설정을 관리합니다.

**Data & Analytics > Log & Crash Search > 설정**을 클릭합니다.


### 검색 필드

로그 검색 시 사용되는 검색 필드를 조회하는 기능으로 시스템 필드인 기본 필드 목록 외에 사용자 전송 필드인 사용자 지정 필드(커스텀 필드)를 확인할 수 있습니다.

![gov_lcs_05_202208](https://static.toastoven.net/prod_logncrash/gov_lcs_05_202208.png)

1. 로그 전송 시 필드 이름이 txt로 시작하는 경우 분석 여부가 true로 설정되고, 그 외에는 분석 여부가 false로 설정됩니다. 분석 여부가 false인 경우 로그 검색의 검색 필드로 등록하여 사용할 수 있습니다.
2. 로그 파일이나 바이너리 파일을 전송하고 **로그 검색** 화면에서 **다운로드 > 보기** 링크를 이용하고자 하는 경우, UserBinaryData 혹은 UserTxtData라는 이름의 필드에 base64 인코딩된 값을 담아 전송하시기 바랍니다.

### 로그 보관 기간

로그 보관 기간을 조회할 수 있습니다.

![gov_lcs_06_202305](https://static.toastoven.net/prod_logncrash/gov_lcs_06_202305.png)

- 로그 보관 기간을 변경하려면 [고객 센터](https://www.nhncloud.com/kr/support/inquiry/?alias=tab2_11)로 문의해 주세요.
- 로그 보관 기간 변경은 다음 달 1일 00시에 적용되며 보관 기간에 따라 요금이 발생합니다.

### 로그 전송 설정

서비스별 로그 전송 여부를 설정합니다.

![gov_lcs_07_202208](https://static.toastoven.net/prod_logncrash/gov_lcs_07_202208.png)

- 일반 로그, Network Insights 로그 각각에 대해 전송 여부를 설정할 수 있습니다.
- TOASK SDK에 대해 전송 여부를 설정 할 수 있습니다.
    - 중복 로그, 로그 레벨, 로그 유형 별로 필터링 할 수 있습니다.
- 설정을 저장한 뒤 앱을 재시작하면 적용됩니다.

### 로그 외부 보관 설정

로그 외부 보관 정보를 설정합니다.

![gov_lcs_08_202208](https://static.toastoven.net/prod_logncrash/gov_lcs_08_202208.png)

- 외부 OBS에 로그를 보관할 수 있습니다.

1. [AWS S3 API](https://gov-docs.toast.com/ko/Storage/Object%20Storage/ko/s3-api-guide-gov/#_1)를 이용해 자격 증명 등록 및 조회로 액세스 키(accessKey)와 비밀 키(secretKey)를 가져옵니다.
2. **로그 외부 보관** 설정에서 **추가** 버튼 클릭
3. 액세스 키와 비밀 키를 비롯한 데이터들 입력합니다.
4. 다른 OBS에 추가로 저장한다면 **추가** 버튼을 눌러 정보를 입력합니다.
5. 모든 OBS 정보를 입력했다면 저장 버튼을 눌러 저장합니다.

- 설정한 OBS로 로그가 저장됩니다.
- [NHN Cloud OBS API 안내 가이드](https://gov-docs.toast.com/ko/Storage/Object%20Storage/ko/s3-api-guide-gov/)
